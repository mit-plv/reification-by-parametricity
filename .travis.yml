language: c

sudo: required

dist: trusty

env: COQ_VERSION="8.12.2"  COQ_PACKAGE="coq-8.12.2 libcoq-8.12.2-ocaml-dev" PPA="ppa:jgross-h/many-coq-versions"

before_install:
  - sudo add-apt-repository "$PPA" -y
  - sudo apt-get update -q
  - sudo apt-get install camlp5 $COQ_PACKAGE -y


before_script:
  - uname -a
  - which coqc
  - which coqtop
  - coqc --version
  - echo | coqtop
  - git clone https://github.com/unicoq/unicoq.git && (cd unicoq && git checkout e1c991b09767887676d07feb2054e4db321216cb)
  - git clone https://github.com/Mtac2/Mtac2.git && (cd Mtac2 && git checkout 653c3a04cfad0adf8fd287cc1fa4e8b9a0be1a34)
  - git clone git@github.com:mattam82/Coq-Equations.git && (cd Coq-Equations && git checkout 837011076e07a8de7e47576e04a6b99fabdab6ad)
  - git clone https://github.com/MetaCoq/metacoq.git && (cd metacoq && git checkout 753ac0ba4817b9506ad5cae3aefff1a2f71dd055)
  - (cd unicoq && coq_makefile -f _CoqProject -o Makefile && make && sudo make install)
  - (cd Mtac2 && coq_makefile -f _CoqProject -o Makefile && make && sudo make install)
  - (cd Coq-Equations && ./configure.sh && make && sudo make install)
  - (cd metacoq && ./configure.sh && make template-coq && sudo make -C template-coq install)

script: make -j2
